function c(){const e=new Uint8Array(56);return window.crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function s(e){const t=new TextEncoder().encode(e),n=await window.crypto.subtle.digest("SHA-256",t);return btoa(String.fromCharCode(...new Uint8Array(n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function i({clientId:e,redirectUri:o,scope:t="openid email profile https://www.googleapis.com/auth/spreadsheets"}){const r=`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:e,redirect_uri:o,response_type:"token",scope:t,prompt:"consent"}).toString()}`;try{console.log("[oauth] Google auth URL:",r)}catch{}return r}export{i as buildAuthUrl,s as generateCodeChallenge,c as generateCodeVerifier};
